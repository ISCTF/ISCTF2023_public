## 七七的欧拉

出题人：D0UBL3SEV3N

![image-20240413230104186](C:\Users\26272\AppData\Roaming\Typora\typora-user-images\image-20240413230104186.png)

下载附件

```
import gmpy2 import libnum 
from crypto.Util.number import * 
 
flag=b'ISCTF{*************}' m=bytes_to_long(flag) 
 
p=libnum.generate_prime(1024) e=libnum.generate_prime(512) 
 
c=pow(m,e,n) 
output = open('output1.txt', 'w') output.write('e=' + str(e) + '\n') output.write('n=' + str(n) + '\n') output.write('c=' + str(c) + '\n') output.close() 


```

不难看出这是一道 RSA 题。附件给出了 e,n 和 c，但是没有 p 和 q。无法求出 phi，直接分解 n。不过注意一点，此时的 n 不是两个大素数相乘的形式，而是 p 的 8 次方。

![descript](file:///C:/Users/26272/Pictures/media/28860360ee29bb270b4ad07fc10eca8c.png?lastModify=1712996760)

了解欧拉函数后得到：phi=（p**k）-(p**k-1)。这里的 k 就是 8。那么可以计算 phi=（p**8） -(p**7) 进而求出私钥 d 和明文 m 代码如下：

```
import gmpy2
import libnum
from crypto.Util.number import *
# 解密脚本
e=8401285423075497989963572888601376313375827722858883767564499066473101615084214973041844878664837606157257039358849583049856161628241418012475432529735909
n=43215244169837806469948347786124868518637093399705956124095500860672112244071440191107980994016600103056456815489801605632161017864478752319768351155313753726788863395874802512110728941865586278973537930986087668680670295786671714198901505996407815947550803914894474620421675292033892360657272741660917412270684699876810837941399253275458100240389371324635182256115787277379407467848918675324981846428928265697775591076094932123320545593664090076855047681633762502816440040677450878996537780234141059730476200412881184046579346892531920437285902316181327165670846216700742563129393052652444861457586099712490776390852046809231081324152165435414725345804142742509799403304595515368302684285082178210606042608051090715344578083556643299027796030508780556907724308428657012493780967758997782558487731711083413311286732498990371338515355565159616999258091394765768255241351112372497092415799038071792520110107948672697151707398953923759207575597215160506806666587199904978636469893389602618447621271424394862752946708581140796875722433121842221267109677449717755857230455244677083870510347602087689568899390504981391893528420872781251739571828041160524027784162166695223096922660360943713081666637382842096152120165641710758744214720704224163189019265257194859917921114143333980044331437519081993588615147253133343337035392394148067737439419861649816425176731174126664304633185095717577665108356007580609768483743533522390449080345014772956966842948160918019441638775095589090407539075846723908238939916722467260262169730133303139710075140648318015647033645916966109000892283029365958480246166918784376187988641866348026475682395267711513236096505981567015952658767367126706774520130543933362944834524802132710324882012599907822890471321059898469724620943021325648090258024210575370918709320148846068638072605211230844236894944019000142322573818015907837355955752581602742484944985505836736887542208601424136315212794643189874254473021354440936630345984556949011993124974592282547464512330789549041599832695858831469599282226986724136483643911216960922878489315657985572178976782213794510423048114494159824340555225998298434828100257803492845474917672192215103514111922512365173418266193380843481365391214152103454883595639850461366320776654607933463450512130148360883332669116


```

得到 flag：

```
ISCTF{3237saq-21se82-3s74f8-8h84ps7-9qw45v7-6bs531-s26h23-c7iu01}
```
