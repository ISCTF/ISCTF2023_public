本题依旧是两部分
step1就是变形就能解
step2要找一个卡迈克尔数，然后有LCG和RSA组合（就硬套）

先解决第一部分
有
$$leak = (e^2+(ed-1)*f)*getPrime(256) + k$$
移项去括号化简，设$p=getPrime(256)$
$$leak - k = pe^2 + (ed-1)*f*p$$
其中f是k的阶乘

e大小为512位，平方为1024位，p为256位，故$pe^2$为1280位
而k在800到1500之间
阶乘函数单调递增，而f(600)为6568位
显然远大于$pe^2$
因此等式两边同除f,$pe^2$为余数，$p*(ed-1)$为倍数
显然两边有公共因子p
若k不对，两边几乎不可能恰好有共同因子且大小为256位
因此因此遍历k，当两边有共同因子且大小为256bit时找到k和p
而已经有除数和倍数，除数和倍数都除以p
可以得到$e^2$和$ed-1$
开方可以得到e，代入右边可以得到d
已知n,e,d可以求得p,q
step1解决。

解决step2，提示有3部分且大小小于一亿，并且为合数但通过素性检验
易知为卡迈克尔数
小于1亿的由三个组成的卡迈克尔数有255个，爆破即可得到56052361

然后此时leak1是典型的rsa题型，$$p^q \equiv q\pmod n$$
$$q^p \equiv p\pmod n$$
因此leak1实际上为$p+q$
与n=p\*q联立解方程，有p和q
然后有leak2解LCG，可以求出下一个随机数seed
然后将key和seed异或算出base
这里实际上是将十进制的c转化为base进制的final
已知base转化回来即可
然后算出十进制下的c
解RSA即可。

